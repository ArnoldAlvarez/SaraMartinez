<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Baile de Memoria Móvil</title>
<style>
body {
  margin: 0;
  padding: 0;
  background: linear-gradient(180deg, #ff8c00, #ff0066);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  font-family: sans-serif;
  color: #fff;
}

h1 {
  margin-bottom: 10px;
}

.game {
  display: flex;
  gap: 50px;
  align-items: flex-end;
  margin-bottom: 20px;
}

.character {
  width: 120px;
  height: 200px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
}

.character .body {
  width: 80px;
  height: 150px;
  border-radius: 20px;
  background-color: yellow;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2em;
  transition: transform 0.3s;
}

.character .head {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background-color: pink;
  margin-bottom: 10px;
  transition: transform 0.3s;
}

.dance {
  transform: translateY(-20px) rotate(-5deg);
}

.shake {
  transform: rotate(20deg);
}

.controls {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: center;
}

.button {
  width: 70px;
  height: 70px;
  border-radius: 15px;
  background-color: #444;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  user-select: none;
  transition: transform 0.1s, background-color 0.2s;
}

.button.active {
  transform: scale(1.2);
  background-color: #fff;
  color: #000;
}
</style>
</head>
<body>

<h1>Baile de Memoria</h1>

<div class="game">
  <div class="character" id="payasita">
    <div class="head" id="payasita-head"></div>
    <div class="body">🤡</div>
  </div>

  <div class="character" id="camaraman">
    <div class="head" id="camaraman-head"></div>
    <div class="body">📹</div>
  </div>
</div>

<div class="controls">
  <div class="button" data-key="A">A</div>
  <div class="button" data-key="S">S</div>
  <div class="button" data-key="D">D</div>
  <div class="button" data-key="F">F</div>
</div>

<script>
const moves = ['A','S','D','F'];
let sequence = [];
let userInput = [];
const maxSteps = 20;

const payasitaHead = document.getElementById('payasita-head');
const camaramanBody = document.querySelector('#camaraman .body');
const buttons = document.querySelectorAll('.button');

function nextRound() {
  userInput = [];
  if(sequence.length < maxSteps){
    sequence.push(moves[Math.floor(Math.random()*moves.length)]);
  }
  playSequence();
}

function playSequence() {
  let i=0;
  const interval = setInterval(()=>{
    const key = sequence[i];
    // iluminar botón correspondiente
    const btn = document.querySelector(`.button[data-key="${key}"]`);
    btn.classList.add('active');
    // animación payasita
    payasitaHead.classList.add('dance');
    setTimeout(()=>{
      btn.classList.remove('active');
      payasitaHead.classList.remove('dance');
    },400);
    i++;
    if(i>=sequence.length) clearInterval(interval);
  },700);
}

// Manejo de botones táctiles
buttons.forEach(btn => {
  btn.addEventListener('touchstart',()=>{
    handleInput(btn.dataset.key);
  });
  btn.addEventListener('click',()=>{ // también funciona en desktop
    handleInput(btn.dataset.key);
  });
});

function handleInput(key){
  // animación camaraman
  const btn = document.querySelector(`.button[data-key="${key}"]`);
  btn.classList.add('active');
  camaramanBody.classList.add('dance');
  setTimeout(()=>{
    btn.classList.remove('active');
    camaramanBody.classList.remove('dance');
  },400);

  userInput.push(key);

  // verificar error
  if(userInput[userInput.length-1] !== sequence[userInput.length-1]){
    payasitaHead.classList.add('shake');
    setTimeout(()=>payasitaHead.classList.remove('shake'),400);
    setTimeout(()=>nextRound(),1000);
  } else if(userInput.length === sequence.length){
    // acierto toda la secuencia
    payasitaHead.classList.add('dance');
    camaramanBody.classList.add('dance');
    setTimeout(()=>{
      payasitaHead.classList.remove('dance');
      camaramanBody.classList.remove('dance');
      nextRound();
    },600);
  }
}

// iniciar juego
nextRound();
</script>

</body>
</html>